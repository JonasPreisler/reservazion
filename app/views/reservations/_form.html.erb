<script>
  $("#modal-window").html("<%= escape_javascript(render 'modals/table') %>");
</script>

<div style="margin-top:20px"></div>

<%= simple_form_for(@reservation) do |f| %>
  <%= f.error_notification %>
  <%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %>


    <br />
  <div style="position: relative">
    <div class="box2">
    <%= text_field_tag("reservation[date]", value = @reservation.date, html_options = { class: 'form-control datepicker', placeholder: 'Seleccione fecha' }) %>
    </div>
    <br />
    <br />

    <div class="box2">
      <%= text_field_tag("reservation[time]", value = @reservation.time&.strftime('%I:%M %p'), html_options = { class: 'form-control timepicker', placeholder: 'Seleccionar hora' }) %>
    </div>
  </div>  

  <br />
  <br />


<% Slot.all.each do |sl| %>
  <div class="flex-container">
    <div>
      <% if sl.date.to_date.today? %>
        <label class="btn btn-primary box3" for="reservation_slot_id_<%=sl.id%>">
          <%= f.radio_button :slot_id, sl.id %>
          <span><%= sl.time.strftime('%H:%M') %></span>
        </label>
      <% end %>
    </div>
  </div>
  <div class="flex-container">
    <div>
      <% if sl.date.to_date == Date.tomorrow %>
        <label class="btn btn-primary box3" for="reservation_slot_id_<%=sl.id%>">
          <%= f.radio_button :slot_id, sl.id %>
          <span><%= sl.time.strftime('%H:%M') %></span>
        </label>
      <% end %>
    </div>
  </div>
<% end %>


  <table>
    <thead>
      <tr>
        <th>
          Today
        </th>
        <th>
          Tomorrow
        </th>
        <th>
          2 days from now
        </th>
        <th>
          3 days from now
        </th>
      </tr>
    </thead>
    <% Slot.all.each do |sl| %>
      <tbody>
        <tr>
          <td>
            <% if sl.date.to_date.today? %>
              <label class="btn btn-primary box3" for="reservation_slot_id_<%=sl.id%>">
                <%= f.radio_button :slot_id, sl.id %>
                <span><%= sl.time.strftime('%H:%M') %></span>
              </label>
            <% end %>
          </td>
        </tr>
        <tr>
          <td>
            <% if sl.date.to_date == Date.tomorrow %>
              <label class="btn btn-primary box3" for="reservation_slot_id_<%=sl.id%>">
                <%= f.radio_button :slot_id, sl.id %>
                <span><%= sl.time.strftime('%H:%M') %></span>
              </label>
            <% end %>
          </td>
        </tr>
        <tr>
          <td>
            <% if sl.date.to_date == Date.today + 2.days %>
              <label class="btn btn-primary box3" for="reservation_slot_id_<%=sl.id%>">
                <%= f.radio_button :slot_id, sl.id %>
                <span><%= sl.time.strftime('%H:%M') %></span>
              </label>
            <% end %>
          </td>
        </tr>
        <tr>
          <td>
            <% if sl.date.to_date == Date.today + 3.days %>
              <label class="btn btn-primary box3" for="reservation_slot_id_<%=sl.id%>">
                <%= f.radio_button :slot_id, sl.id %>
                <span><%= sl.time.strftime('%H:%M') %></span>
              </label>
            <% end %>
          </td>
        </tr>
      </tbody>
    <% end %>
  </table>


    <br />
    <br />
    <center>
      <%= f.number_field :guest, placeholder: "¿Cuántos invitados?", class: 'box4 number_field' %>
    </center>
    <br />
    <br />


    <center>

      <%= link_to 'Seleccionar tabla', tables_path, {:remote => true, 'data-toggle' =>  "modal", 'data-target' => '#modal-window', class: 'btn btn-primary box3 btn-group"'}  %>
      <div id="modal-window" class="modal" tabindex="-1" role="dialog" aria-labelledby="gridModalLabel" aria-hidden="true">


        <%= image_tag ('/tables.png'), class: 'responsive' %>

        <br />
        <br />
        <br />

        <% Table.all.each do |rt| %>
          <label class="btn btn-primary box3" for="reservation_table_id_<%=rt.id%>">
            <%= f.radio_button :table_id, rt.id %>
            <span><%= rt.id %></span>
          </label>
        <% end %>

        <br />
        <br />
        <br />

        <div class="form-actions">
          <%= f.submit "Reserva", class: 'btn-submit box2' %>
        </div>
      </div>
    </center>

<% end %>
